<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
    <title>Timer</title>
    <link rel="stylesheet" href="../mini/style.css">
    <style>
        .container {
            padding-top: clamp(10%, 3vw, 30%);
        }

        .btn_time {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: row;
            gap: 1.5vw;
            padding: 2.5rem 0;
            transition: all 0.1s ease-in-out;
        }

        button {
            padding: 10px 15px;
            background: var(--color-second);
            color: var(--color-fourth);
            font-size: clamp(20px, 3vw, 50px);
            font-family: var(--font-default);
            cursor: pointer;
        }

        input[type="number"] {
            width: clamp(60px, 20%, 300px);
            padding: 12px 15px;
            background: var(--color-second);
            color: var(--color-fourth);
            font-size: clamp(20px, 3vw, 50px);
            font-family: var(--font-default);
            text-align: center;
            cursor: pointer;
        }

        .set {
            background: var(--color-third);
            color: var(--color-fourth);
        }

        .start {
            background: var(--color-third);
        }

        .reset {
            background: var(--color-fourth);
            color: var(--color-second);
        }

        .pause {
            background: var(--color-second);
        }

        .stop {
            background: var(--color-second);
        }

        .time {
            font-family: var(--font-default);
            font-size: clamp(40px, 10vw, 100px);
            transition: all 0.1s ease-in-out;
        }

        .time .msec {
            font-family: var(--font-default);
            font-size: 0.75em;
        }

        .end {
            font-family: var(--font-default);
            font-size: clamp(24px, 9vw, 88px);
            transition: all 0.1s ease-in-out;
        }

        .none {
            display: none;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <a href="javascript:history.back();" class="back">üëàüèª</a>

        <div class="container">
            <h1 class="timer">
                <strong class="time">00:00<span class="msec">.00</span></strong>
            </h1>

            <!-- Í∏∞Î≥∏ ÏÉÅÌÉú -->
            <div class="btn_time">
                <input type="number" class="min" placeholder="Î∂Ñ" min="0">
                <input type="number" class="sec" placeholder="Ï¥à" min="0" max="59">
                <button class="set">ÏÑ§Ï†ïüëåüèª</button>
            </div>

            <!-- ÏÑ§Ï†ï ÌõÑ -->
            <div class="btn_time">
                <button class="start">ÏãúÏûë‚ñ∂Ô∏è</button>
                <button class="reset">Ïû¨ÏÑ§Ï†ïüîÑÔ∏è</button>
            </div>

            <!-- Ïã§Ìñâ Ï§ë -->
            <div class="btn_time">
                <button class="pause">ÏùºÏãúÏ†ïÏßÄ‚è∏Ô∏è</button>
                <button class="stop">Ï§ëÏßÄ‚èπÔ∏è</button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const timerEl = document.querySelector(".timer"); // h1.timer Ï†ÑÏ≤¥
            let display = document.querySelector(".timer .time"); // strong.time
            const minInput = document.querySelector(".min");
            const secInput = document.querySelector(".sec");
            const setBtn = document.querySelector(".set");
            const startBtn = document.querySelector(".start");
            const resetBtn = document.querySelector(".reset");
            const pauseBtn = document.querySelector(".pause");
            const stopBtn = document.querySelector(".stop");

            let duration = 0;      // ÌÉÄÏù¥Î®∏ Ï†ÑÏ≤¥ ms
            let remaining = 0;     // ÎÇ®ÏùÄ ÏãúÍ∞Ñ
            let startTime = 0;
            let paused = false;
            let timerId = null;

            function format(ms) {
                const totalSec = Math.max(0, Math.floor(ms / 1000));
                const min = String(Math.floor(totalSec / 60)).padStart(2, "0");
                const sec = String(totalSec % 60).padStart(2, "0");
                const msec = String(Math.floor((ms % 1000) / 10)).padStart(2, "0");
                return `${min}:${sec}<span class="msec">.${msec}</span>`;
            }

            function update() {
                const now = performance.now();
                const elapsed = now - startTime;
                remaining = duration - elapsed;

                if (remaining <= 0) {
                    stopTimer();
                    timerEl.innerHTML = `<strong class="end">ÌÉÄÏù¥Î®∏ Ï¢ÖÎ£å!! ü•≥</strong>`; // Ï¢ÖÎ£å Î©îÏãúÏßÄ
                } else {
                    display.innerHTML = format(remaining);
                    timerId = requestAnimationFrame(update);
                }
            }

            function startTimer() {
                if (!duration) return; // ÏÑ§Ï†ï Ïïà ÌïòÎ©¥ Ïã§Ìñâ Ïïà Ìï®
                startTime = performance.now();
                if (paused) {
                    startTime -= (duration - remaining);
                    paused = false;
                }
                timerId = requestAnimationFrame(update);
            }

            function pauseTimer() {
                paused = true;
                cancelAnimationFrame(timerId);
            }

            function stopTimer() {
                cancelAnimationFrame(timerId);
                remaining = 0;
                timerEl.innerHTML = `<strong class="time">00:00<span class='msec'>.00</span></strong>`;
                display = document.querySelector(".timer .time"); // Îã§Ïãú Ï∞∏Ï°∞
            }

            // ÏÑ§Ï†ï Î≤ÑÌäº
            setBtn.addEventListener("click", () => {
                const min = parseInt(minInput.value || 0, 10);
                const sec = parseInt(secInput.value || 0, 10);
                duration = (min * 60 + sec) * 1000;
                remaining = duration;
                timerEl.innerHTML = `<strong class="time">${format(remaining)}</strong>`;
                display = document.querySelector(".timer .time"); // Îã§Ïãú Ï∞∏Ï°∞
            });

            startBtn.addEventListener("click", startTimer);
            pauseBtn.addEventListener("click", pauseTimer);
            stopBtn.addEventListener("click", stopTimer);
            resetBtn.addEventListener("click", () => {
                cancelAnimationFrame(timerId);
                remaining = duration;
                timerEl.innerHTML = `<strong class="time">${format(remaining)}</strong>`;
                display = document.querySelector(".timer .time"); // Îã§Ïãú Ï∞∏Ï°∞
                paused = false;
            });
        });
    </script>

</body>

</html>
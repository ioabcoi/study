<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
    <title>World</title>
    <link rel="stylesheet" href="../mini/style.css">
    <style>
        .container {
            margin-top: clamp(120px, 20vw, 200px);
            padding: 1rem;
        }

        .text {
            position: fixed;
            left: 0;
            top: clamp(30px, 10vw, 100px);
            width: 100%;
            color: var(--color-third);
            font-family: var(--font-default);
            font-size: clamp(20px, 8vw, 40px);
            text-align: center;
        }

        .text:hover {
            text-shadow: 3px 3px 0 var(--color-fourth);
        }

        .index {
            display: grid;
            place-items: center;
            grid-template-columns: repeat(2, 1fr);
            align-items: stretch;
            justify-content: stretch;
            gap: clamp(1vw, 2vw, 20px);
            width: clamp(280px, 80%, 1080px);
            margin: 0 auto;
        }

        .item {
            display: flex;
            align-items: stretch;
            justify-content: stretch;
            width: 100%;
            height: 100%;
        }

        .item .box {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            width: 100%;
            height: 100%;
            padding: clamp(2vw, 5vw, 20px);
            background: var(--color-second);
            border-radius: 10px;
        }

        .item .box * {
            color: var(--color-fourth);
            font-family: var(--font-default);
            font-size: clamp(18px, 4vw, 28px);
        }

        .item .box .city {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px dashed var(--color-fourth);
            color: var(--color-third);
        }

        .item .box .datetime span {
            display: block;
        }

        .item .box:hover {
            background: var(--color-third);
            box-shadow: 5px 5px 0 var(--color-fourth);
        }

        .item .box:hover .city {
            color: var(--color-first);
        }

        .box_add {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: row;
            gap: 1.5vw;
            width: clamp(280px, 80%, 1080px);
            margin: 0 auto;
            padding: 2.5rem 0;
            transition: all 0.1s ease-in-out;
        }

        select {
            display: flex;
            padding: 15px;
            background: var(--color-fourth);
            border: 1px solid var(--color-fourth);
            color: var(--color-third);
            font-size: clamp(20px, 3vw, 50px);
            font-family: var(--font-default);
            cursor: pointer;
        }

        select option {
            font-size: clamp(20px, 3vw, 50px);
            font-family: var(--font-default);
        }

        button {
            display: flex;
            padding: 10px 15px;
            background: var(--color-third);
            border: 1px solid var(--color-third);
            color: var(--color-fourth);
            font-size: clamp(20px, 3vw, 50px);
            font-family: var(--font-default);
            cursor: pointer;
        }

        .remove {
            position: absolute;
            right: 0.5rem;
            top: 0.5rem;
            background: none;
            border: 0;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <a href="javascript:history.back();" class="back">ğŸ‘ˆğŸ»</a>

        <div class="container">
            <div class="world-clock">
                <h1 class="text">ì„¸ê³„ ì‹œê³„</h1>
                <ul class="index">
                    <!-- <li class="item">
                        <div class="box">
                            <strong class="city">ëŒ€í•œë¯¼êµ­ ì„œìš¸</strong>
                            <div class="datetime">
                                <span class="date" data-timezone="Asia/Seoul">0000-00-00 (ìš”ì¼)</span>
                                <span class="time" data-timezone="Asia/Seoul">00:00:00</span>
                            </div>
                        </div>
                    </li>
                    <li class="item">
                        <div class="box">
                            <strong class="city">ì¼ë³¸ ë„ì¿„</strong>
                            <div class="datetime">
                                <span class="date" data-timezone="Asia/Tokyo">0000-00-00 (ìš”ì¼)</span>
                                <span class="time" data-timezone="Asia/Tokyo">00:00:00</span>
                            </div>
                        </div>
                    </li>
                    <li class="item">
                        <div class="box">
                            <strong class="city">ìŠ¤ìœ„ìŠ¤ ì·¨ë¦¬íˆ</strong>
                            <div class="datetime">
                                <span class="date" data-timezone="Europe/Zurich">0000-00-00 (ìš”ì¼)</span>
                                <span class="time" data-timezone="Europe/Zurich">00:00:00</span>
                            </div>
                        </div>
                    </li>
                    <li class="item">
                        <div class="box">
                            <strong class="city">ë¯¸êµ­ ë‰´ìš•</strong>
                            <div class="datetime">
                                <span class="date" data-timezone="America/New_York">0000-00-00 (ìš”ì¼)</span>
                                <span class="time" data-timezone="America/New_York">00:00:00</span>
                            </div>
                        </div>
                    </li> -->
                </ul>

                <div class="box_add">
                    <select name="" id="" class="sel">
                        <option value="">ğŸ—ºï¸ êµ­ê°€ ì„ íƒ</option>
                        <option value="Asia/Shanghai" data-city="ì¤‘êµ­ ìƒí•˜ì´">ì¤‘êµ­ ìƒí•˜ì´</option>
                        <option value="Europe/London" data-city="ì˜êµ­ ëŸ°ë˜">ì˜êµ­ ëŸ°ë˜</option>
                        <option value="Australia/Sydney" data-city="í˜¸ì£¼ ì‹œë“œë‹ˆ">í˜¸ì£¼ ì‹œë“œë‹ˆ</option>
                        <option value="America/Los_Angeles" data-city="ë¯¸êµ­ LA">ë¯¸êµ­ LA</option>
                        <option value="America/Chicago" data-city="ë¯¸êµ­ ì‹œì¹´ê³ ">ë¯¸êµ­ ì‹œì¹´ê³ </option>
                        <option value="Europe/Paris" data-city="í”„ë‘ìŠ¤ íŒŒë¦¬">í”„ë‘ìŠ¤ íŒŒë¦¬</option>
                    </select>
                    <button class="add">â• ì¶”ê°€</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        function updateWorldClock() {
            const now = new Date();

            document.querySelectorAll(".world-clock .datetime").forEach(wrapper => {
                const tz = wrapper.querySelector(".date").dataset.timezone;

                // ë‚ ì§œ í¬ë§·
                const dateFormatter = new Intl.DateTimeFormat("ko-KR", {
                    timeZone: tz,
                    year: "numeric",
                    month: "2-digit",
                    day: "2-digit",
                    // weekday: "short"
                    weekday: "long"
                });

                // ì‹œê°„ í¬ë§·
                const timeFormatter = new Intl.DateTimeFormat("ko-KR", {
                    timeZone: tz,
                    hour: "2-digit",
                    minute: "2-digit",
                    second: "2-digit",
                    hour12: false
                });

                wrapper.querySelector(".date").textContent = dateFormatter.format(now);
                wrapper.querySelector(".time").textContent = timeFormatter.format(now);
            });
        }

        // ìµœì´ˆ ì‹¤í–‰ + 1ì´ˆë§ˆë‹¤ ê°±ì‹ 
        updateWorldClock();
        setInterval(updateWorldClock, 1000);

        const select = document.querySelector(".sel");
        const addBtn = document.querySelector(".add");
        const indexList = document.querySelector(".index");

        // ê¸°ë³¸ ë„ì‹œë“¤
        const defaultCities = [
            { tz: "Asia/Seoul", city: "ëŒ€í•œë¯¼êµ­ ì„œìš¸" },
            { tz: "Asia/Tokyo", city: "ì¼ë³¸ ë„ì¿„" },
            { tz: "Europe/Zurich", city: "ìŠ¤ìœ„ìŠ¤ ì·¨ë¦¬íˆ" },
            { tz: "America/New_York", city: "ë¯¸êµ­ ë‰´ìš•" },
        ];

        // ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
        function saveCities() {
            const cities = Array.from(indexList.querySelectorAll(".date")).map(el => ({
                tz: el.dataset.timezone,
                city: el.closest(".box").querySelector(".city").textContent
            }));
            localStorage.setItem("worldClockCities", JSON.stringify(cities));
        }

        function loadCities() {
            const saved = JSON.parse(localStorage.getItem("worldClockCities") || "[]");

            // ì €ì¥ëœ ê²Œ ìˆìœ¼ë©´ ê·¸ê±¸ ë¶ˆëŸ¬ì˜¤ê¸°
            if (saved.length > 0) {
                saved.forEach(({ tz, city }) => createCityItem(tz, city));
            } else {
                // ì—†ìœ¼ë©´ ê¸°ë³¸ ë„ì‹œ ì„¸íŒ…
                defaultCities.forEach(({ tz, city }) => createCityItem(tz, city));
            }
            updateWorldClock();
        }

        // li ìƒì„± í•¨ìˆ˜
        function createCityItem(tz, city) {
            const li = document.createElement("li");
            li.className = "item";
            li.innerHTML = `
        <div class="box">
            <strong class="city">${city}</strong>
            <div class="datetime">
                <span class="date" data-timezone="${tz}">0000-00-00 (ìš”ì¼)</span>
                <span class="time" data-timezone="${tz}">00:00:00</span>
            </div>
            <button class="remove">â–</button>
        </div>
    `;
            indexList.appendChild(li);
        }

        // ë„ì‹œ ì¶”ê°€
        addBtn.addEventListener("click", () => {
            const option = select.options[select.selectedIndex];
            const tz = option.value;
            const city = option.dataset.city;

            if (!tz) return;

            // ì¤‘ë³µ ì²´í¬
            const exists = Array.from(indexList.querySelectorAll(".date"))
                .some(el => el.dataset.timezone === tz);
            if (exists) {
                alert("ì´ë¯¸ ì¶”ê°€ëœ ë„ì‹œì˜ˆìš”!");
                return;
            }

            createCityItem(tz, city);
            updateWorldClock();
            saveCities(); // ì¶”ê°€ í›„ ì €ì¥
        });

        // ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ìœ„ì„
        indexList.addEventListener("click", (e) => {
            if (e.target.classList.contains("remove")) {
                e.target.closest(".item").remove();
                saveCities(); // ì‚­ì œ í›„ ì €ì¥
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        document.addEventListener("DOMContentLoaded", loadCities);

    </script>

</body>

</html>